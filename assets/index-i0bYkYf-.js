import{j as d}from"./jsx-runtime-QvZ8i92b.js";import{r as c,R as Y}from"./index-uubelm5h.js";const N=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:{};function Z(t,e=200){let n=0,s=0,r=0;return function(...o){const i=Date.now();clearTimeout(r),!n||i-n>e?s=e:s=e-(i-n),r=setTimeout(()=>{t(...o)},s),n=i}}function S(t){return`${t}-${Math.random().toString(36).slice(2)}`}N.requestIdleCallback=N.requestIdleCallback||N.requestAnimationFrame||setTimeout;const G="sw-";function P(t){return`${G}${t}`}function j(...t){return t.reduce((e,n)=>{if(!n)return e;const s=typeof n;if(s==="string")return e.push(n),e;if(Array.isArray(n))return e.push(j(...n)),e;if(s==="object")return Object.keys(n).forEach(r=>{const o=n[r];if(typeof o=="function")try{o()&&e.push(r)}catch(i){console.error("clsx object function error",i,o)}else o&&e.push(r)}),e;if(s==="function"){try{e.push(j(n()))}catch(r){console.error("clsx function error",r,n)}return e}return e},[]).join(" ")}function $(t){return Object.keys(t).reduce((e,n)=>(n.startsWith("data-")&&(e[n]=t[n]),e),{})}function X(t,e){const n={};return(t.style||e.style)&&(n.style={...t.style,...e.style}),(t.className||e.className)&&(n.className=j(t.className,e.className)),Object.assign(n,$(t),$(e))}function C(t,e="px"){return typeof t=="number"?t+e:t}function x(t,e){const{style:n,className:s,alignment:r,children:o,...i}=t,a=X({style:n,className:s},e);return a["data-alignment"]=r,{children:o,commonProps:a,restProps:i}}const H=typeof window<"u"&&typeof document<"u",I=H&&"ontouchstart"in document.documentElement,O=I?"touchstart":"mousedown",q=I?"touchmove":"mousemove",A=I?"touchend":"mouseup",h={_events:{},on(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},off(t,e){if(this._events[t]){if(!e){delete this._events[t];return}this._events[t]=this._events[t].filter(n=>n!==e)}},emit(t,...e){this._events[t]&&this._events[t].forEach(n=>{try{n(...e)}catch(s){console.warn("event bus error",t,s)}})}};function J(t){const{children:e,commonProps:n,restProps:s}=x(t,{className:[P("zstack"),P("container")]});return d.jsx("div",{...n,...s,children:e})}J.__docgenInfo={description:"",methods:[],displayName:"ZStack",props:{alignment:{required:!1,tsType:{name:"EAlignment"},description:""}},composes:["IBaseComponent"]};const k=c.createContext({boxDirection:"row"}),L=c.createContext({eventPrefix:"",append:()=>{},removeLast:()=>{},count:()=>0,dismiss:()=>{}});function K(){return c.useContext(L)}const M=t=>t&&typeof t=="object"&&!Object.isFrozen(t);function E(t){return M(t)&&(Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(e){if(!t.hasOwnProperty(e)||!M(t[e]))return;const n=Object.getOwnPropertyDescriptor(t,e);n&&(n.get||n.set)||E(t[e])})),t}function D(t,e){if(t===e||Number.isNaN(t)&&Number.isNaN(e))return!0;if(typeof t!="object"||typeof e!="object"||t===null||e===null||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!D(t[n],e[n]))return!1;return!0}function Q(t){return t instanceof Promise||t&&typeof t.then=="function"}const ee=()=>{};function te(t,e){const{onChange:n=ee}={};let s=E(t);const r=new Set,o=a=>{const[p,l]=c.useState(a(s));return c.useEffect(()=>{const u=m=>{l(f=>{const g=a(m);return D(f,g)?f:E(g)})};return r.add(u),()=>{r.delete(u)}},[]),p};function i(a){const p=typeof a=="function"?a(s):a,l=u=>{D(s,u)||(s=E(u),r.forEach(m=>m(s)),n(s))};if(Q(p))return p.then(u=>l(u));l(p)}return{useStore(){const[a,p]=c.useState(!1);return c.useEffect(()=>{const l=()=>p(u=>!u);return r.add(l),()=>{r.delete(l)}},[]),s},getStore(){return s},setStore:i,useSelector:o,useSelect:o}}const z=te(null);if(H){const t=()=>{const e=window.innerWidth,n=window.innerHeight,s=e>n,r={width:e,height:n,landscape:s};z.setStore(r)};window.addEventListener("resize",Z(t),{passive:!0}),t()}function ne(t){const{alignment:e="center",spacing:n,...s}=t,{commonProps:r,restProps:o,children:i}=x(s,{className:["sw-hstack","sw-container",`align-${e}`],style:{"--hstack-spacing":C(n||0)}});return d.jsx(k.Provider,{value:{boxDirection:"row"},children:d.jsx("div",{...r,...o,children:i})})}ne.__docgenInfo={description:"",methods:[],displayName:"HStack",props:{alignment:{required:!1,tsType:{name:"EAlignment"},description:`The guide for aligning the subviews in this stack.
 This guide has the same vertical screen coordinate for every child view.`},spacing:{required:!1,tsType:{name:"number"},description:`The distance between adjacent subviews,
 or nil if you want the stack to choose a default distance for each pair of subviews.`}},composes:["IBaseComponent"]};function se(t){const{spacing:e,...n}=t,{children:s,commonProps:r,restProps:o}=x(n,{className:[P("vstack"),P("container")],style:{"--vstack-spacing":C(e||0)}});return d.jsx(k.Provider,{value:{boxDirection:"column"},children:d.jsx("div",{...r,...o,children:s})})}se.__docgenInfo={description:"",methods:[],displayName:"VStack",props:{alignment:{required:!1,tsType:{name:"EAlignment"},description:""},spacing:{required:!1,tsType:{name:"number"},description:`The distance between adjacent subviews,
 or nil if you want the stack to choose a default distance for each pair of subviews.`}},composes:["IBaseComponent"]};function re(t){const{minLength:e,...n}=t,{commonProps:s,restProps:r}=x(n,{style:{"--min-length":C(e||0)},className:"sw-spacer"});return d.jsx("div",{...s,...r})}re.__docgenInfo={description:"",methods:[],displayName:"Spacer",props:{minLength:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:""}},composes:["Omit"]};function oe(t){const{lineLimit:e,...n}=t,s=e?{"--line-limit":e}:void 0,{commonProps:r,restProps:o,children:i}=x(n,{className:[P("text"),s?"line-clamp":!1],style:s});return d.jsx("div",{...r,...o,children:i})}oe.__docgenInfo={description:"",methods:[],displayName:"Text",props:{lineLimit:{required:!1,tsType:{name:"number"},description:`The maximum number of lines to use for rendering text.
default to 0, which means no limit.`}},composes:["IBaseComponent"]};function ie(t){const{direction:e,showsIndicators:n=!0,...s}=t,{commonProps:r,restProps:o,children:i}=x(s,{className:[P("scrollview"),e||"vertical",n?"":"no-scroll-bar"]});return d.jsx("div",{...r,...o,children:i})}ie.__docgenInfo={description:"",methods:[],displayName:"ScrollView",props:{direction:{required:!1,tsType:{name:"union",raw:"'horizontal' | 'vertical'",elements:[{name:"literal",value:"'horizontal'"},{name:"literal",value:"'vertical'"}]},description:"The direction of the scroll view, default to vertical."},showsIndicators:{required:!1,tsType:{name:"boolean"},description:"Whether to show the scroll bar, default to true."}},composes:["IBaseComponent"]};function ae(t){const e=c.useContext(k),{commonProps:n,restProps:s}=x(t,{className:`sw-divider ${e.boxDirection}`});return d.jsx("div",{...n,...s})}ae.__docgenInfo={description:"",methods:[],displayName:"Divider",composes:["Omit"]};const V=c.forwardRef(function(e,n){const{type:s="page",...r}=e,{commonProps:o,restProps:i,children:a}=x(Object.assign({},r),{className:["sw-page"],"data-page-type":s});return d.jsx("div",{...o,...i,ref:n,children:a})});V.__docgenInfo={description:"",methods:[],displayName:"StandardPage",props:{type:{required:!1,tsType:{name:"literal",value:"'page'"},description:"page type, default to 'page'"}},composes:["IPageBaseComponent"]};function U(t){const e=c.useRef(null),n=P("dragbar");return c.useEffect(()=>{var u;if(!((u=t.container)!=null&&u.current)||!e.current)return;const s=t.container.current,r=e.current;let o=0,i=0;const a=m=>{m.preventDefault();const f=I?m.touches[0].clientY:m.clientY;i=Math.max(o-Math.max(20,f),200),s.style.height=`${i}px`},p=()=>{h.emit(t.eventToChangeDetent,i),document.removeEventListener(q,a),document.removeEventListener(A,p)},l=m=>{m.preventDefault(),o=s.getBoundingClientRect().bottom,document.addEventListener(q,a),document.addEventListener(A,p)};return r.addEventListener(O,l),()=>{r.removeEventListener(O,l)}},[t.container,t.eventToChangeDetent,e]),d.jsx("div",{className:n,ref:e,children:d.jsx("span",{className:P("dragbar-indicator")})})}U.__docgenInfo={description:"",methods:[],displayName:"DragBar",props:{eventToChangeDetent:{required:!0,tsType:{name:"string"},description:""},presentationDetents:{required:!0,tsType:{name:"Array",elements:[{name:"IPresentationDetent"}],raw:"IPresentationDetent[]"},description:""},container:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLDivElement | undefined",elements:[{name:"HTMLDivElement"},{name:"undefined"}]}],raw:"RefObject<HTMLDivElement | undefined>"},description:""}}};const ce={medium:"60%",large:"90%"},ue=800;function de(t){const e=z.useStore();return c.useMemo(()=>{const n=(e==null?void 0:e.height)||ue,s=t.map(o=>{if(typeof o=="number")return o;const i=ce[o]||o;if(!/^\d+%$/.test(i))throw new Error(`Invalid detent size: ${o}, should be a number or a percentage string like '60%'`);return Math.floor(n*parseFloat(i)/100)}),r=s[0];return{sizes:s.sort((o,i)=>o-i).filter((o,i,a)=>a.indexOf(o)===i),default:r}},[t,e])}function pe(t){const e=de(t.presentationDetents),n=c.useRef(e.sizes.indexOf(e.default)),s=c.useCallback(r=>{var p;if(!((p=t.container)!=null&&p.current))return;const o=t.container.current,i=()=>{o.classList.remove("animate-height"),o.removeEventListener("transitionend",i)};o.addEventListener("transitionend",i),o.classList.add("animate-height");const a=le(r,e.sizes);o.style.height=`${a}px`},[t.container,e]);c.useEffect(()=>{var i;if(!((i=t.container)!=null&&i.current))return;const r=t.container.current,o=e.sizes[n.current];`${o}px`!==r.style.height&&s(o)},[t.container,e,s]),c.useEffect(()=>(h.on(t.eventToChangeDetent,r=>{console.log("height",r),s(r)}),()=>{h.off(t.eventToChangeDetent)}),[t.eventToChangeDetent,s])}function le(t,e){for(let n=0;n<e.length;n++){const s=e[n];if(s>t&&n===0||n===e.length-1)return s;const r=e[n+1];if(!(t>r))return t-s<r-t?s:r}}const me=["medium","large"],F=c.forwardRef(function(e,n){const s=c.useRef(null),r=c.useRef(`change-height-${Math.random().toString(36).slice(2)}`),{type:o,presentationDetents:i=me,...a}=e,{commonProps:p,restProps:l,children:u}=x(a,{className:["sw-page"],"data-page-type":o});return pe({container:s,eventToChangeDetent:r.current,presentationDetents:i}),c.useImperativeHandle(n,()=>s.current,[]),d.jsxs("div",{...p,...l,ref:s,children:[d.jsx(U,{eventToChangeDetent:r.current,container:s,presentationDetents:i}),u]})});F.__docgenInfo={description:"",methods:[],displayName:"ActionSheet",props:{presentationDetents:{required:!1,tsType:{name:"Array",elements:[{name:"IPresentationDetent"}],raw:"IPresentationDetent[]"},description:""},type:{required:!0,tsType:{name:"literal",value:"'actionsheet'"},description:"page type, default to 'page'"}},composes:["IPageBaseComponent"]};const R=class R extends c.Component{constructor(e){super(e),this.containerRef=Y.createRef(),this.pageType=e.type||"page",console.log("[page] created",this.pageType,this.props.id)}componentDidMount(){if(!this.containerRef.current)return;const e=this.containerRef.current;if(this.props.noEnteringAnimation){h.emit(`${this.context.eventPrefix}.page-entered`,this.props.id);return}const n=()=>{h.emit(`${this.context.eventPrefix}.page-entered`,this.props.id),e.removeEventListener("animationend",n)};e.addEventListener("animationend",n),e.setAttribute("date-page-status","entering")}shouldComponentUpdate(e){return this.props.id!==e.id||this.props.type!==e.type}UNSAFE_componentWillUpdate(e){console.log("[page] update",this.pageType,this.props.id),console.log("[page] previous",this.props,"nextProps",e)}render(){console.log("[page] render",this.pageType,this.props.id);const{noEnteringAnimation:e,...n}=this.props;switch(this.pageType){case"actionsheet":return d.jsx(F,{...n,type:"actionsheet",ref:this.containerRef});default:return d.jsx(V,{...n,type:"page",ref:this.containerRef})}}exitPage(e){if(!this.containerRef.current)return;const n=this.containerRef.current,s=()=>{n.removeEventListener("animationend",s),e&&e()};n.addEventListener("animationend",s),n.setAttribute("date-page-status","exiting")}};R.contextType=L;let _=R;_.__docgenInfo={description:"",methods:[{name:"exitPage",docblock:`exit page
@param callback callback function executed after page exit animation is done
@returns`,modifiers:[],params:[{name:"callback",description:"callback function executed after page exit animation is done",optional:!0,type:{name:"IFn",alias:"IFn"}}],returns:null,description:"exit page"}],displayName:"Page"};const B=S("_index_");function fe(t){const e=c.useRef([]),n=c.useRef(`${S("navi")}`),s=c.useRef({eventPrefix:n.current,append:u=>h.emit(`${n.current}.append`,u),removeLast:(u=1)=>h.emit(`${n.current}.remove`,u),count:()=>e.current.length,dismiss:()=>h.emit(`${n.current}.remove`,1)}),r=c.useRef({}),o=c.useMemo(()=>({component:()=>d.jsx(d.Fragment,{children:t.children}),type:"page",id:B,_id:`page$$${B}`}),[t.children]),[i,a]=c.useState([o]);c.useEffect(()=>{const u=n.current,m={};return h.on(`${u}.append`,f=>{const g=f.type||"page",y=e.current,w=`${g}$$${f.id}`;let v;const T=y.findIndex(b=>b._id===w);if(!(y.length&&T===y.length-1)){if(T===-1){v=Object.assign({},f,{type:g,_id:w});let b=y.findLastIndex(W=>W.type==="page");b===-1&&(b=y.length-1),e.current=[...y.slice(0,b+1),v]}else v=y[T],e.current=[...y.slice(T,1),v];v.type==="page"&&(m[v._id]=()=>{a([v]),delete m[v._id]}),a(b=>[...b,v])}}),h.on(`${u}.remove`,f=>{if(!f||!e.current.length)return;const g=e.current[e.current.length-1];e.current=e.current.slice(0,-f);const y=r.current;if(g.type!=="page"){y[g._id]?y[g._id].exitPage(()=>{a(v=>v.slice(0,-f))}):a(v=>v.slice(0,-f));return}const w=e.current[e.current.length-1]||o;a([w,g]),requestIdleCallback(()=>{y[g._id]?y[g._id].exitPage(()=>{a([w])}):a([w])})}),h.on(`${u}.page-entered`,f=>{var g;(g=m[f])==null||g.call(m)}),()=>{h.off(`${u}.append`),h.off(`${u}.remove`),h.off(`${u}.page-entered`)}},[o]),r.current={};const{commonProps:p,restProps:l}=x(t,{style:{},className:"sw-navigationstack"});return{commonProps:p,restProps:l,pageInstances:r,shownPages:i,contextValue:s}}function ge(t){const{commonProps:e,restProps:n,shownPages:s,contextValue:r,pageInstances:o}=fe(t);return d.jsx(L.Provider,{value:r.current,children:d.jsx("div",{...e,...n,children:s.map((i,a)=>{const p=i.component;return d.jsx(_,{noEnteringAnimation:a===0||a<s.length-1,id:i._id,ref:l=>o.current[i._id]=l,type:i.type,children:d.jsx(p,{})},i._id)})})})}ge.__docgenInfo={description:"",methods:[],displayName:"NavigationStack",composes:["IBaseComponent"]};function he(t){const{commonProps:e,restProps:n,children:s}=x(t,{className:"sw-button"});return d.jsx("button",{...e,...n,children:s})}he.__docgenInfo={description:"",methods:[],displayName:"Button",composes:["IBaseElementComponent"]};function ye(t){const{commonProps:e,restProps:n}=x(t,{className:"sw-image"});return d.jsx("img",{...e,...n})}ye.__docgenInfo={description:"",methods:[],displayName:"Image",composes:["Omit"]};function ve(t){const{destination:e,dismiss:n,pageOptions:s,...r}=t,o=K(),i=c.useRef(S("page")),{commonProps:a,restProps:p,children:l}=x(r,{className:"sw-navigationlink"}),u=c.useCallback(()=>{if(n){o.removeLast();return}if(!e){console.warn("NavigationLink: destination is not set");return}if(typeof e=="string"){window.location.href=e;return}o.append({component:e,type:s==null?void 0:s.type,id:i.current})},[e,o,n,s]);return d.jsx("div",{...a,...p,onClick:u,children:l})}ve.__docgenInfo={description:"",methods:[],displayName:"NavigationLink",props:{destination:{required:!1,tsType:{name:"union",raw:"string | ComponentType",elements:[{name:"string"},{name:"ComponentType"}]},description:"next page component or url"},pageOptions:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  type: IPageType
}`,signature:{properties:[{key:"type",value:{name:"IPageType",required:!0}}]}},description:""},dismiss:{required:!1,tsType:{name:"boolean"},description:"dismiss current page (back to previous page)"}},composes:["IBaseComponent"]};export{he as B,ae as D,ne as H,ye as I,ve as N,re as S,oe as T,se as V,J as Z,ge as a,ie as b};
